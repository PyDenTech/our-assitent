version: 1.0
runtime: nodejs20
# App Runner vai rodar "npm ci" por padr√£o.
build:
  commands:
    - npm ci --omit=dev
run:
  command: node server.js
  network:
    port: 3001
  env:
    - name: NODE_ENV
      value: production
    - name: PORT
      value: "3001"
    - name: FRONTEND_URL
      value: "https://ourassistent.pydentech.com" # Amplify
    - name: JWT_SECRET
      value: "COLOQUE_UM_SEGREGO_FORTE_AQUI" # sobrescreva em Console se preferir
    - name: GOOGLE_CLIENT_ID
      value: "***REMOVED***"
    - name: GOOGLE_CLIENT_SECRET
      value: "***REMOVED***"
    - name: GOOGLE_REDIRECT_URI
      value: "https://api.ourassistent.pydentech.com/auth/google/callback"
healthcheck:
  path: /health
  interval: 10 # segundos
  timeout: 5
  healthyThreshold: 1
  unhealthyThreshold: 5
autoDeploymentsEnabled: true
cpu: 1 vCPU
memory: 2 GB
